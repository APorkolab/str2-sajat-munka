<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="./assets/css/style.css">
	<link href="./assets/css/font-awesome-4.7.0/css/font-awesome.min.css" rel="stylesheet">
	<title>Game of Thrones</title>
</head>

<body>
	<div class="sidenav">
		<a href="#" id=logo>Game of Thrones</a>
		<p id="charDetails"></p>

		<input id="searchbar" onkeyup="search_character()" type="text" name="search"
			placeholder="&#xF002; Search a character" style="font-family: Arial, 'FontAwesome'">

		<input style="font-family: FontAwesome" value="&#xf054;" type="button" id="search_btn" onclick="noNeedMsg()">


		<script type="text/javascript">
			function noNeedMsg() {
				alert("It is no need to push the button. Just begin to type into the searchbar.:)");
			}

			function search_character() {
				let input = document.getElementById('searchbar').value
				input = input.toLowerCase();
				let x = document.getElementsByClassName('charCard');

				let countNumber;
				for (i = 0; i < x.length; i++) {
					if (!x[i].innerHTML.toLowerCase().includes(input)) {
						x[i].style.display = "none";
					} else {
						x[i].style.display = "list-item";
					}
				}
			}

		</script>


	</div>
	<div id="main">
		<div class="flex-container" id="con">
		</div>
	</div>
	<script>
		fetch("./assets/json/got.json")
			.then(function (response) {
				return response;
			})
			.then(function (data) {
				return characters = data.json();
			})
			.then(function (Normal) {
				document.getElementById("con").innerHTML = Normal.filter(character => character.dead !== true)
					.sort(function (a, b) {
						if (a.name < b.name) {
							return -1;
						}
						if (a.name > b.name) {
							return 1;
						}
						return 0;
					})
					.map(
						(data) => {
							return `<div class='charCard' id='${data.name}'> 
							<img 
							 onmouseover="makeRed('${data.name}')"
							 onmouseout="makeNormal('${data.name}')" 
							 src="./assets/${data.portrait}" 
							 alt="A Game of Thrones character" 
							 onclick="selectCharacter(\'${data.name}\');makeBold(\'${data.name}\');"
							 width="90"
							/>
							<h4 class="allCharNames">${data.name}</h4>
				</div>` ;
						}
					);
				console.log(characters);

			})
			.catch(function (err) {
				console.log("Fetch problem show: " + err.message);
			});


		let selectCharacter = (charName = 'Brienne') => {
			fetch("./assets/json/got.json")
				.then(function (response) {
					return response;
				})
				.then(function (data) {
					return data.json();
				})
				.then(function (Normal) {
					document.getElementById("charDetails").innerHTML = Normal.filter(character => character.name === charName)
						.map(
							(data) => {
								return `<div>
								<img class="portraitSelected" src="./assets/${data.picture}" alt="A Game of Thrones character" width="520" >
									<h4> ${data.name} <img class="houseMedal" src="./assets/assets/houses/${data.house}.png" alt="(commoner)" width="30" ></h4>
									<h4>${data.bio}</h4>
								</div>`;
							}
						);
				})
				.catch(function (err) {
					console.log("Fetch problem show: " + err.message);
				});
		}

		function makeBold(charName) {
			let TextBox = document.getElementById(charName);
			TextBox.style.fontFamily = "Roboto', sans-serif";
			TextBox.style.fontWeight = "900";

		}

		function makeRed(charName) {
			let TextBox = document.getElementById(charName);
			TextBox.style.color = "red";
		}

		function makeNormal(charName) {
			let TextBox = document.getElementById(charName);
			TextBox.style.fontFamily = "GOT, sans-serif";
			TextBox.style.color = "#81695f";
		}




	</script>
</body>

</html>